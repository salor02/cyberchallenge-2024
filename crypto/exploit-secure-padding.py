import socket
import string
import time

HOST = "padding.challs.cyberchallenge.it"  # Standard loopback interface address (localhost)
PORT = 9030  # Port to listen on (non-privileged ports are > 1023)

alfa = string.ascii_letters + '0123456789_{}'
with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
    s.connect((HOST, PORT))

    data = s.recv(1024)
    print(data.decode())
    msg = ''
    s.sendall(bytes(msg.encode()))
    data = s.recv(1024)
    print(data.decode())

    #time.sleep(10)

    msg = 'ciaociaociaocia'
    to_send = msg + '\n'
    s.sendall(bytes(to_send.encode()))
    data = s.recv(1024).decode()
    prev_oracle = data[39:71]
    print(data)
    print(msg + ' ' + prev_oracle)

    found = ""

    for i in range(16):
        for char in alfa:
            to_send = ""
            to_send = msg + found + char + '\n'
            print(to_send)
            s.sendall(bytes(to_send.encode()))
            time.sleep(0.5)
            data = s.recv(1024).decode()
            oracle = data[39:71]
            print(oracle)

            if oracle == prev_oracle:
                found = found + char
                num = 2 + len(found)
                msg = to_send[0:-num]
                print('[FOUND] ' + found)
                time.sleep(1)
                to_send = msg + '\n'
                print(to_send)
                s.sendall(bytes(to_send.encode()))
                time.sleep(0.2)
                data = s.recv(1024).decode()
                prev_oracle = data[39:71]
                print("[NEW ORACLE] " + prev_oracle)
                break

    