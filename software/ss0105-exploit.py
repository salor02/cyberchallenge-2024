from pwn import *

HOST = 'piecewise.challs.cyberchallenge.it'
PORT = 9110

conn = remote(HOST, PORT)

flag = ""

data = conn.recvuntil(b')').decode()
while not '}' in data:
    print(data)
    if 'empty' in data:
        conn.sendline()
        flag = conn.recvline_contains(b'flag').decode()
        print("flag" + flag + "]")
        data = conn.recvline_contains(b')').decode()
        continue
    
    line = data.split(' ')
    print(line)
    number = line[5]
    byte = line[11][1:]
    endian = line[9].split('-')[0]
    to_send = pack(int(number),int(byte) * 8, endian)
    print(number + ' ' + byte + ' ' + endian)
    print(to_send)

    conn.send(to_send)
    flag = conn.recv().decode()
    print("flag" + flag + "]")
    data = conn.recvline_contains(b')').decode()

#conn.interactive()